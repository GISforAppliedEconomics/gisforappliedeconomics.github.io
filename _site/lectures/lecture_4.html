<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">

	<!-- Titles and author for Metadata -->
	<title>GIS for Applied Economics</title>
	<meta name="description" content="GIS for Applied Economics">
	<meta name="author" content="Juan Carlos Muñoz-Mora">

	<!-- Options for screen -->
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

	<!-- Templates -->
	<link rel="stylesheet" href="reveal.js/css/reveal.css">
	<link rel="stylesheet" href="reveal.js/css/theme/white.css" id="theme">
	<link rel="stylesheet" href="reveal.js-own-style/print.css"  type="text/css" media="print">

	<!-- Code syntax highlighting -->
	<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">
	<!--[if lt IE 9]>
	<script src="reveal.js/lib/js/html5shiv.js"></script>
	<![endif]-->
	<script async defer src="https://buttons.github.io/buttons.js"></script>
	</head>

	<!-- ...  ...  ...  ... ... ... ... ... .. .. ..-->
	<!-- ...  ...  ...  ... ... ... ... ... .. .. ..-->
	<!-- 				Content 					-->
	<!-- ...  ...  ...  ... ... ... ... ... .. .. ..-->
	<!-- ...  ...  ...  ... ... ... ... ... .. .. ..-->

	<body>
		<div class="reveal">
			<div class="slides">
			<!-- START SLIDES -->
			<!-- ...  ...  ...  ... ... ... ... ... .. .. ..-->
			<!-- 				Slide 1	 -- Title			-->
			<!-- ...  ...  ...  ... ... ... ... ... .. .. ..-->

<!-- Section 1: General Introduction  -->
<section data-markdown  data-separator="^\n===\n" data-separator-vertical="^\n---\n" >
<script type="text/template">

# GIS for Applied Economics #
<br>

## Raster Data in Economics
<br>

Juan Carlos Muñoz-Mora <br>
Univeristat Pompeu Fabra
<br>
[juancarlos.munoz@upf.edu](mailto:juancarlos.munoz@upf.edu)
<br> 
Nov 2016


===

# Roadmap #

1. Where we are?
2. Basic concepts of Remote Sensing Dataset
4. GIS techniques for raster data
5. Satellite data in action
6. Replication

===

# Where we are? #

![Fatigue-related accident](inputs/lecture_1/course_overview.png)


===
<!-- .slide: data-background-color="#000000" data-background-video="inputs/lecture_4/Earth.mp4,https://s3.amazonaws.com/static.slid.es/site/homepage/v1/homepage-video-editor.webm" data-background-video-loop data-background-video-muted -->

# Satellite Data in Economics 
<small>[(Donaldson and Storeygard, 2016)](http://pubs.aeaweb.org/doi/pdfplus/10.1257/jep.30.4.171)<!-- .element target="_blank" --> </small>


- Access to information difficult to obtain by other means <!-- .element class="fragment" data-fragment-index="1" -->
- High Spatial Resolution <!-- .element class="fragment" data-fragment-index="2" --> 
- Wide Geographical coverage<!-- .element class="fragment" data-fragment-index="3" -->


---
<!-- .slide: data-background-color="#000000" data-background-video="inputs/lecture_4/geostationary.mp4,https://s3.amazonaws.com/static.slid.es/site/homepage/v1/homepage-video-editor.webm" data-background-video-loop data-background-video-muted -->

# Geostationary Orbit

<small>Source: [NASA (2016)](https://svs.gsfc.nasa.gov/4040)<!-- .element target="_blank" --> </small>


---
<!-- .slide: data-background-color="#000000" data-background-video="inputs/lecture_4/sun_synchronous.mp4,https://s3.amazonaws.com/static.slid.es/site/homepage/v1/homepage-video-editor.webm" data-background-video-loop data-background-video-muted -->

# Sun-Synchronous Orbit

<small>Source: [NASA (2016)](https://svs.gsfc.nasa.gov/4040) </small>


---
<!-- .slide: data-background-color="#000000" -->

## Geostationary vs Sun-Synchronous

- Resolution (36.000km vs 6.000)
- Comparability (fixed vs mobile)
- "swath" = area cover by a given overpass

---
<!-- .slide: data-background-color="#000000" -->

## Resolution

![QGIS_1](inputs/lecture_4/high_low_resolution.png)<!-- .element style="border: none; background: none; box-shadow:none; width:700px; float: center;" -->

Units (degrees, arc-seconds, mts)


---
<!-- .slide: data-background-color="#000000" -->

## Sensors and  Bands

![QGIS_1](inputs/lecture_4/band.jpg)<!-- .element style="border: none; background: none; box-shadow:none; width:900px; float: center;" -->

<small>Source: [NASA (2016)](https://svs.gsfc.nasa.gov/4040) </small>


---
<!-- .slide: data-background-color="#000000" -->

## Processing

- Creating 
- Correcting projections (Orthorectification)
- Cloud cover 
- Forest fire

$\rightarrow$ pixel as data

---
<!-- .slide: data-background-color="#000000" -->

## Interpretation

- Supervised
- Unsupervised
- Mixed methods

---
<!-- .slide: data-background-color="#000000" -->

# So, raster data-set are only satellite pictures?

---
<!-- .slide: data-background-color="#000000" -->

# Some example data sets

---
<!-- .slide: data-background-color="#000000" -->

## Nightlight


![QGIS_1](inputs/lecture_4/nighlight.png)<!-- .element style="border: none; background: none; box-shadow:none; width:600px; float: center;" -->

(Free access,1-64 values, 75km-1km Resolution, time series) 

---
<!-- .slide: data-background-color="#000000" -->

## Elevation

(Free access,mts,30m) 

![QGIS_1](inputs/lecture_4/elevation.jpg)<!-- .element style="border: none; background: none; box-shadow:none; width:800px; float: left;" -->

<small>Source: [NASA (2016)](http://earthobservatory.nasa.gov/Features/ShuttleRetrospective/page6.php)<!-- .element target="_blank" --> </small>


---
<!-- .slide: data-background-color="#000000" -->

## Other sources

![QGIS_1](inputs/lecture_4/Donaldson_Table_Sources.png)<!-- .element style="border: none; background: none; box-shadow:none; width:600px; float: center;" -->

<small>[(Donaldson and Storeygard, 2016)](http://pubs.aeaweb.org/doi/pdfplus/10.1257/jep.30.4.171)<!-- .element target="_blank" --> </small>



===

# GIS techniques for raster 

- Global Operations
 	- Re-classification 
 	- Terrain Model
- Local Operations
	- Zonnal Statistics
	- Terrain Model
	- Cell Statistics
	- Focal Statistics 

---

## Raster Re-classification 

![QGIS_1](inputs/lecture_4/raster_oper_reclasification_0.png)<!-- .element style="border: none; background: none; box-shadow:none; width:400px; float: left;" -->

![QGIS_1](inputs/lecture_4/raster_oper_reclasification_1.gif)<!-- .element style="border: none; background: none; box-shadow:none; width:400px; float: right;" -->

---


## Terrain Model (Elevation, Topography,..)

Distances, coverage, among other uses.

![QGIS_1](inputs/lecture_4/raster_oper_terrain_model.jpg)<!-- .element style="border: none; background: none; box-shadow:none; width:600px; float: center;" -->


---

## Zonnal Statistics (I)


![QGIS_1](inputs/lecture_4/raster_oper_zonnal.png)<!-- .element style="border: none; background: none; box-shadow:none; width:400px; float: center;" -->

- Extract Statistics from a given zone (vector)
- Stats=count,min,max,sum,median,std
- Continuous vs Categorical Raster
- CRS 

---

## Zonnal Statistics (II) - Rasterization Strategy


![QGIS_1](inputs/lecture_4/raster_oper_zonnal_2.png)<!-- .element style="border: none; background: none; box-shadow:none; width:400px; float: center;" -->

source: [Rasterstat library](http://pythonhosted.org/rasterstats/manual.html)<!-- .element target="_blank" -->

---

## Cell Statistics

![QGIS_1](inputs/lecture_4/raster_oper_cell.png)<!-- .element style="border: none; background: none; box-shadow:none; width:400px; float: center;" -->

---

## Focal Statistics

zonnal statistics?

![QGIS_1](inputs/lecture_4/raster_oper_focal.png)<!-- .element style="border: none; background: none; box-shadow:none; width:400px; float: center;" -->


===

# Satellite data in action

---

## [Combining satellite imagery and machine learning to predict poverty](http://science.sciencemag.org/content/353/6301/790.full.pdf+html)<!-- .element target="_blank" -->

Neal Jean, Marshall Burke, Michael Xie, W. Matthew Davis, David B. Lobell, and Stefano Ermon

Science
Volume 353(6301):790-794
August 19, 2016

---

## Visualization of features

![QGIS_1](inputs/lecture_4/stanford_project_method.png)<!-- .element style="border: none; background: none; box-shadow:none; width:600px; float: center;" -->

[Neal Jean et al. Science 2016;353:790-794](http://science.sciencemag.org/content/353/6301/790.full.pdf+html)

---

## Prediction Performance

![QGIS_1](inputs/lecture_4/stanford_project_results.png)<!-- .element style="border: none; background: none; box-shadow:none; width:600px; float: center;" -->

[Neal Jean et al. Science 2016;353:790-794](http://science.sciencemag.org/content/353/6301/790.full.pdf+html)

---

## [Evolving Comparative Advantage and the Impact of Climate Change in Agricultural Markets: Evidence from 1.7 Million Fields Around the World.](http://www.journals.uchicago.edu/doi/abs/10.1086/684719)<!-- .element target="_blank" -->

Arnaud Costinot, Dave Donaldson, and Cory Smith.

Journal of Political Economy (2016) - 124(1):205–248.

---

to quantify the macro-level consequences of micro-level climate shocks for a variety of crops and locations.

### Data

50 Countries  and 10 crops for each 1.7 millions fields covering the surface of the earth (data from before and after). Crop by crop production.


### Main Findings

Impact to a 0.26 percent reduction in global GDP when trade and production patterns are allowed to adjust. ... this corresponds to about one-sixth of total crop value.

---

### Pre-climate change estimates of agricultural productivity

Food and Agricultural Organization's Global Agro-Ecological Zones (GAEZ)

- Growing characteristics from field (!!)
- Crop Specification (Supervising)
- Assuption technology or production

Resolution: 5-arc-minute

### Post-climate change estimates of agricultural productivity

Different scenarios from scientist' predictions

---
### Predicted yield changes

![QGIS_1](inputs/lecture_4/Donaldson_Climate_change_1.jpg)<!-- .element style="border: none; background: none; box-shadow:none; width:600px; float: center;" -->

---
<!-- .slide: data-background-image="inputs/lecture_4/Donaldson_Climate_change_2_Page_1.png" data-background-size="450px" -->

---

## [There Is No Free House: Ethnic Patronage in a Kenyan Slum](http://www.mit.edu/%7Etavneet/Marx_Stoker_Suri.pdf)

Benjamin Marx, Thomas M Stoker, Tavneet Suri (MIT)

August 2016

---

## General Idea

evidence of ethnic patronage (ethnic favoritism) in the housing market in a large Kenyan slum.
- Chief different tribe $\uparrow$ rents $\downarrow$ quality housing
- Chief same  tribe $\downarrow$ rents $\uparrow$ quality housing (investment)

## Data

Household-level data (own collections), Chief Surveys and high resolution satellite imagery (0.5 mts resolution)

---

## Assessing housing quality

<table border="0" cellpadding="0" cellspacing="0">
<tr>
	<td>July 2009</td>
	<td>August 2012</td>
</tr>
<tr>
<td>
![QGIS_1](inputs/lecture_4/Marx_Stoker_Suri_1.jpg)<!-- .element style="border: none; background: none; box-shadow:none; width:450px; float: left;" -->
</td>
<td>
![QGIS_1](inputs/lecture_4/Marx_Stoker_Suri_2.jpg)<!-- .element style="border: none; background: none; box-shadow:none; width:450px; float: right;" -->
</td>
</tr>
</table>

Luminosity reflected by metal roofs (investment)

---

<small>Distribution of Household Tribes in Kibera</small>

![QGIS_1](inputs/lecture_4/Marx_Stoker_Suri_3_sample.jpg)<!-- .element style="border: none; background: none; box-shadow:none; width:500px; float: center;" -->

<small>Roofs from Satellite Images in Kibera (January 2011)</small>

![QGIS_1](inputs/lecture_4/Marx_Stoker_Suri_4_Satellital.jpg)<!-- .element style="border: none; background: none; box-shadow:none; width:500px; float: center;" -->

---

# [Ethnic Diversity and Growth: Revisiting the Evidence](http://conference.nber.org/confer/2016/SI2016/POL/Montalvo_Reynal-Querol.pdf)

Jose Montalvo and Marta Reynal-Querol

<a style="font-size:20px;color:white" href="" target="_blank">Montalvo and Reynal-Querol (2016)</a> </p>

(2016)

(under submission)

---

### Main Question

Ethnic Heterogeneity vs Economic Growth
(mixed theoretical evidence)

$\rightarrow$ the effect of the size of geographical units on the relationship between ethnic diversity and growth

### Strategy

- Build exogenous boundaries (grid-country cell)
- Ethnic Fractionalization
- Zonnal Statistics for all variables 

---

![QGIS_1](inputs/lecture_4/Montalvo_Reynal_1.png)<!-- .element style="border: none; background: none; box-shadow:none; width:800px; float: center;" -->

---

![QGIS_1](inputs/lecture_4/Montalvo_Reynal_2.png)<!-- .element style="border: none; background: none; box-shadow:none; width:800px; float: center;" -->

---

## Other papers to have a look

- [Nunn and Puga (2011)](http://www.mitpressjournals.org/doi/abs/10.1162/REST_a_00161)
	- Terrain ruggedness $\rightarrow$ income per capita
	- Terrain Ruggedness index (Focal Statistics)
- [Mayshar, Moav, Neeman and Pascali (2015)]()
	- What caused the formation of the state
	- Ethographic Atlas and GAEZ ()
- More papers
	- see [Donaldson and Storeygard (2016)](http://pubs.aeaweb.org/doi/pdfplus/10.1257/jep.30.4.171)<!-- .element target="_blank" -->

===

# Replication Section

## [The Origins of Ethnolinguistic Diversity](https://www.aeaweb.org/articles?id=10.1257/aer.102.4.1508)

Stelios Michalopoulos

American Economic Review, 2012, 102(4): 1508-1539


---

### Main idea

Did geographic diversity cause ethnic diversity?

### Data

- Spatial Distribution of languages 
- Polygon of linguistic group
- Suitability Index for agriculture (Ramankutty et al. 2002)[http://dx.doi.org/10.1046/j.1466-822x.2002.00294.x]<!-- .element target="_blank" -->
	- 0.5 x 0.5 resolution
- Other variables [Yale - G-Econ database](http://gecon.yale.edu/)<!-- .element target="_blank" -->

---

![QGIS_1](inputs/lecture_4/Stelios_1.png)<!-- .element style="border: none; background: none; box-shadow:none; width:800px; float: center;" -->

---

### Some threats (Endogenous Location/Land Quality)

- Countries with centralized modern state may have homogenized both languages and land quality
	- Sub-national analysis
	- Linguistic groups (Ethnologue 15th)

- Country boundaries endogenous
	- Solution: Exogenous earth grid 2.5&deg x 2.5&deg

- Dyadic regression
	- Can control for raster cell FE

---

### Virtual country example

![QGIS_1](inputs/lecture_4/Stelios_2.png)<!-- .element style="border: none; background: none; box-shadow:none; width:800px; float: center;" -->

---

### Cross-"virtual country" regression

<small>$ln(Languages_i))= \beta_0 + \beta_1 Latitude_i + \beta_2 sd(Elevation)_i+ \beta_3 sd(LandQuality)_i+x'\beta_4 + u_i$</small>

---

![QGIS_1](inputs/lecture_4/Stelios_3.png)<!-- .element style="border: none; background: none; box-shadow:none; width:800px; float: center;" -->

===

# Let's replicate!

---

## Desktop Solutions

- Replicate Figure 1 (Visualization)
- Zonnal Statistis 

---

## Tips for PyQGIS

Zonnal Statistics
<pre><code data-trim data-noescape>
processing.runalg("qgis:zonalstatistics", input_raster, 
	band_number, input_vector,
	column_prefix, load_flag, output_layer)
</code></pre>

---

## Tips for rasterstats


<pre><code data-trim data-noescape>
from rasterstats import zonal_stats
zonal_stats(shp, raster,
            stats="count min mean max median")
</code></pre>


</script>
</section>



<!-- END SLIDES -->
		</div>
	</div>

<!-- ...  ...  ...  ... ... ... ... ... .. .. ..-->
<!-- ...  ...  ...  ... ... ... ... ... .. .. ..-->
<!-- 				Scripts Options				-->
<!-- ...  ...  ...  ... ... ... ... ... .. .. ..-->
<!-- ...  ...  ...  ... ... ... ... ... .. .. ..-->


	<!-- Basic Scripts Set Up -->
	<script src="reveal.js/lib/js/head.min.js"></script>
	<script src="reveal.js/js/reveal.js"></script>

	<!-- Basic Scripts Set Up -->
	<script>
			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				// Display controls in the bottom right corner
				controls: true,
				// Display a presentation progress bar
				progress: true,
				// Push each slide change to the browser history
				history: true,
				center: true,
				mouseWheel: true,
				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // none/fade/slide/convex/concave/zoom 
			    //  Add annotation into the board
			    chalkboard: { // font-awesome.min.css must be available
					src: "chalkboard/chalkboard.json",
					toggleChalkboardButton: { left: "80px" },
					toggleNotesButton: { left: "130px" },
    			},
    			math: {
					// mathjax: 'http://cdn.mathjax.org/mathjax/latest/MathJax.js',
					config: 'TeX-AMS_HTML-full'
				},
				menu: { // Menu works best with font-awesome installed: sudo apt-get install fonts-font-awesome
					themes: false,
					transitions: false,
					markers: true,
					hideMissingTitles: true,
					custom: [
				            { title: 'Plugins', icon: '<i class="fa fa-external-link"></i>', src: 'toc.html' },
				            { title: 'About', icon: '<i class="fa fa-info"></i>', src: 'about.html' }
				        ]
				},
				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // none/fade/slide/convex/concave/zoom

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					// For Markdown Codes
					{ src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'reveal.js/plugin/math/math.js', async: true },
					{ src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },		
					{ src: 'reveal.js-plugins/menu/menu.js' },
					{ src: 'reveal.js-plugins/chalkboard/chalkboard.js' },
				],
				keyboard: {
			        67: function() { RevealChalkboard.toggleNotesCanvas() },    // toggle notes canvas when 'c' is pressed
			        66: function() { RevealChalkboard.toggleChalkboard() }, // toggle chalkboard when 'b' is pressed
			        46: function() { RevealChalkboard.clear() },    // clear chalkboard when 'DEL' is pressed
			         8: function() { RevealChalkboard.reset() },    // reset chalkboard data on current slide when 'BACKSPACE' is pressed
			        68: function() { RevealChalkboard.download() }, // downlad recorded chalkboard drawing when 'd' is pressed
    			
    			},

			});
	</script>

</body>
</html>
